<view class="feedback-container ink-paper">
  <!-- 页面头部 -->
  <view class="feedback-header">
    <view class="header-title ink-title">亲友反馈</view>
    <view class="header-subtitle">表达您对家族故事的支持</view>
    <view class="ink-divider"></view>
  </view>
  
  <!-- 点赞区域 -->
  <view class="like-section content-container">
    <view class="like-content">
      <view class="like-icon-wrapper" bindtap="showIdentitySelector">
        <view class="like-icon">❤️</view>
        <view class="like-animation {{showLikeAnimation ? 'show' : ''}}">+1</view>
      </view>
      <view class="like-info">
        <view class="like-count" wx:if="{{!loadingLikeCount}}">{{likeCount}}</view>
        <view class="like-count loading" wx:else>...</view>
        <view class="like-text">位亲友点赞</view>
      </view>
    </view>
    <view class="like-description">
      如果这个家族故事触动了您的心，请点击爱心献出支持
    </view>
  </view>
  
  <!-- 身份选择弹窗 -->
  <view class="identity-modal {{showIdentitySelector ? 'show' : ''}}" wx:if="{{showIdentitySelector}}">
    <view class="modal-overlay" bindtap="hideIdentitySelector"></view>
    <view class="modal-content">
      <view class="modal-header">
        <view class="modal-title">选择点赞身份</view>
        <view class="modal-close" bindtap="hideIdentitySelector">×</view>
      </view>
      
      <view class="identity-options">
        <view 
          class="identity-option {{identityType === 'anonymous' ? 'active' : ''}}"
          bindtap="onIdentityTypeChange"
          data-type="anonymous"
        >
          <view class="option-icon">🕶️</view>
          <view class="option-text">匿名点赞</view>
          <view class="option-desc">以匿名身份献出爱心</view>
        </view>
        <view 
          class="identity-option {{identityType === 'custom' ? 'active' : ''}}"
          bindtap="onIdentityTypeChange"
          data-type="custom"
        >
          <view class="option-icon">👤</view>
          <view class="option-text">自定义昵称</view>
          <view class="option-desc">以自定义昵称献出爱心</view>
        </view>
      </view>
      
      <!-- 自定义昵称输入框 -->
      <view class="custom-nickname-input" wx:if="{{identityType === 'custom'}}">
        <input 
          class="nickname-input"
          placeholder="请输入您的昵称（如：三儿子、小华等）"
          value="{{customNickname}}"
          bindinput="onCustomNicknameInput"
          maxlength="20"
        />
      </view>
      
      <view class="modal-actions">
        <button 
          class="confirm-button"
          bindtap="confirmLike"
          disabled="{{submitting}}"
        >
          {{submitting ? '点赞中...' : '确认点赞'}}
        </button>
      </view>
    </view>
  </view>
  
  <!-- 点赞记录列表 -->
  <view class="likes-section">
    <view class="likes-header">
      <view class="likes-title">最近点赞记录</view>
      <view class="likes-subtitle">优先显示有昵称的亲友</view>
    </view>
    
    <!-- 点赞记录列表 - 紧凑横排形式 -->
    <view class="likes-list" wx:if="{{likes.length > 0}}">
      <view class="likes-container content-container">
        <block wx:for="{{likes}}" wx:key="id">
          <view class="like-record">
            <text class="like-record-text">
              <text class="nickname">{{item.nickName || '匿名用户'}}</text>
              <text class="action">献出了爱心</text>
              <text class="time">{{item.createTime}}</text>
            </text>
          </view>
        </block>
      </view>
    </view>
    
    <!-- 空状态 -->
    <view class="empty-likes" wx:if="{{likes.length === 0 && !loadingLikes}}">
      <view class="empty-icon">💝</view>
      <view class="empty-text">还没有人点赞，快来第一个献出爱心吧</view>
    </view>
    
    <!-- 加载状态 -->
    <view class="loading-likes" wx:if="{{loadingLikes}}">
      <view class="loading-text">正在加载点赞记录...</view>
    </view>
  </view>
</view>